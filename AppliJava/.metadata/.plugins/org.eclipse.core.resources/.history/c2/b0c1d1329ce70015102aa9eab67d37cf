import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.IOException;
import java.security.KeyManagementException;
import java.security.NoSuchAlgorithmException;
import java.util.ArrayList;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLayeredPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;

import org.json.JSONException;
import org.json.simple.parser.ParseException;

public class MainWindow extends JFrame {
	
	private JFrame frame;
    private JLayeredPane lpane;
    private JPanel panelFond;
    private JPanel panelHead;
    private ArrayList<Tweet> twitter;
    private JTable tabTwitter;
	private JButton refresh;

	public JFrame getFrame() {
		return frame;
	}

	public void setFrame(JFrame frame) {
		this.frame = frame;
	}

	public JLayeredPane getLpane() {
		return lpane;
	}

	public void setLpane(JLayeredPane lpane) {
		this.lpane = lpane;
	}

	public JPanel getPanelFond() {
		return panelFond;
	}

	public void setPanelFond(JPanel panelFond) {
		this.panelFond = panelFond;
	}

	public JPanel getPanelHead() {
		return panelHead;
	}

	public void setPanelHead(JPanel panelHead) {
		this.panelHead = panelHead;
	}

	public ArrayList<Tweet> getTwitter() {
		return twitter;
	}

	public void setTwitter(ArrayList<Tweet> twitter) {
		this.twitter = twitter;
	}

	public JTable getTabTwitter() {
		return tabTwitter;
	}

	public void setTabTwitter(JTable tabTwitter) {
		this.tabTwitter = tabTwitter;
	}

	public JButton getRefresh() {
		return refresh;
	}

	public void setRefresh(JButton bouton) {
		this.refresh = bouton;
	}

	public MainWindow() throws IOException, ParseException, JSONException
    {
    	frame = new JFrame();
    	lpane = new JLayeredPane();
    	panelFond = new JPanel();
    	panelHead = new JPanel();
    	refresh = new JButton("Refresh");
	}
    
    public void Init(Json json) throws IOException, ParseException, JSONException{
    	
    	twitter = json.ParseJson();
    	
    	frame.setPreferredSize(new Dimension(600, 500));
        frame.setLayout(new BorderLayout());
        frame.add(lpane);
        
        lpane.setBounds(0, 0, 600, 500);
        panelFond.setBackground(Color.lightGray);
        panelFond.setBounds(0, 50, 600, 450);
        panelFond.setOpaque(true);
        panelHead.setBackground(Color.blue);
        frame.add(panelHead, BorderLayout.NORTH);
        panelHead.setSize(new Dimension(600, 50));
        panelHead.setOpaque(true);
        panelHead.setLayout(new BorderLayout());        
       

  
        tabTwitter = new JTable(new TweetModel(twitter));
        tabTwitter.setRowHeight(100);
        tabTwitter.setSize(new Dimension(600,450));
        JScrollPane scroll = new JScrollPane(tabTwitter);
        panelFond.add(scroll);

        
        lpane.add(panelFond, new Integer(0), 0);
        lpane.add(panelHead, new Integer(1), 0);   
        
        refresh.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent event) {
					
				Api api = new Api();
				
				Json jsonRefresh;
				try {
					jsonRefresh = new Json(api);
					
					ArrayList<Tweet> twitterUpdate = jsonRefresh.ParseJson();
					//tabTwitter = new JTable(new TweetModel(tweets));
					tabTwitter.setModel(new TweetModel(twitterUpdate));
					//panelFond.repaint();
				} catch (KeyManagementException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				} catch (NoSuchAlgorithmException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				} catch (IOException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				} catch (ParseException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				} catch (JSONException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
				
			}
		});
        panelHead.add(refresh,BorderLayout.WEST);

        frame.pack();
        frame.setVisible(true);
    }
}
